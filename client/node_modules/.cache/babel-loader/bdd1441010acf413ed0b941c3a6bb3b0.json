{"ast":null,"code":"import _defineProperty from \"/home/ubuntu/Capstone/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/home/ubuntu/Capstone/client/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"/home/ubuntu/Capstone/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/home/ubuntu/Capstone/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/ubuntu/Capstone/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/ubuntu/Capstone/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/ubuntu/Capstone/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/ubuntu/Capstone/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/ubuntu/Capstone/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/ubuntu/Capstone/client/src/components/Todos.tsx\";\nimport dateFormat from 'dateformat';\nimport update from 'immutability-helper';\nimport * as React from 'react';\nimport { Button, Checkbox, Divider, Grid, Header, Icon, Input, Image, Loader } from 'semantic-ui-react';\nimport { createTodo, deleteTodo, getTodos, patchTodo } from '../api/todos-api';\nexport var Todos =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(Todos, _React$PureComponent);\n\n  function Todos() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Todos);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Todos)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      todos: [],\n      newTodoName: '',\n      loadingTodos: true\n    };\n\n    _this.handleNameChange = function (event) {\n      _this.setState({\n        newTodoName: event.target.value\n      });\n    };\n\n    _this.onEditButtonClick = function (todoId) {\n      _this.props.history.push(\"/todos/\".concat(todoId, \"/edit\"));\n    };\n\n    _this.onTodoCreate =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        var dueDate, newTodo;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                dueDate = _this.calculateDueDate();\n                _context.next = 4;\n                return createTodo(_this.props.auth.getIdToken(), {\n                  name: _this.state.newTodoName,\n                  dueDate: dueDate\n                });\n\n              case 4:\n                newTodo = _context.sent;\n\n                _this.setState({\n                  todos: [].concat(_toConsumableArray(_this.state.todos), [newTodo]),\n                  newTodoName: ''\n                });\n\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n                alert('Todo creation failed');\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 8]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.onTodoDelete =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(todoId) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return deleteTodo(_this.props.auth.getIdToken(), todoId);\n\n              case 3:\n                _this.setState({\n                  todos: _this.state.todos.filter(function (todo) {\n                    return todo.todoId != todoId;\n                  })\n                });\n\n                _context2.next = 9;\n                break;\n\n              case 6:\n                _context2.prev = 6;\n                _context2.t0 = _context2[\"catch\"](0);\n                alert('Todo deletion failed');\n\n              case 9:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[0, 6]]);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.onTodoCheck =\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(pos) {\n        var todo;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                todo = _this.state.todos[pos];\n                _context3.next = 4;\n                return patchTodo(_this.props.auth.getIdToken(), todo.todoId, {\n                  name: todo.name,\n                  dueDate: todo.dueDate,\n                  done: !todo.done\n                });\n\n              case 4:\n                _this.setState({\n                  todos: update(_this.state.todos, _defineProperty({}, pos, {\n                    done: {\n                      $set: !todo.done\n                    }\n                  }))\n                });\n\n                _context3.next = 10;\n                break;\n\n              case 7:\n                _context3.prev = 7;\n                _context3.t0 = _context3[\"catch\"](0);\n                alert('Todo deletion failed');\n\n              case 10:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, null, [[0, 7]]);\n      }));\n\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    return _this;\n  }\n\n  _createClass(Todos, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4() {\n        var todos;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                _context4.next = 3;\n                return getTodos(this.props.auth.getIdToken());\n\n              case 3:\n                todos = _context4.sent;\n                this.setState({\n                  todos: todos,\n                  loadingTodos: false\n                });\n                _context4.next = 10;\n                break;\n\n              case 7:\n                _context4.prev = 7;\n                _context4.t0 = _context4[\"catch\"](0);\n                alert(\"Failed to fetch todos: \".concat(_context4.t0.message));\n\n              case 10:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[0, 7]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      return (\n        /*#__PURE__*/\n        React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 7\n          }\n        },\n        /*#__PURE__*/\n        React.createElement(Header, {\n          as: \"h1\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 9\n          }\n        }, \"TODOs\"), this.renderCreateTodoInput(), this.renderTodos())\n      );\n    }\n  }, {\n    key: \"renderCreateTodoInput\",\n    value: function renderCreateTodoInput() {\n      return (\n        /*#__PURE__*/\n        React.createElement(Grid.Row, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 7\n          }\n        },\n        /*#__PURE__*/\n        React.createElement(Grid.Column, {\n          width: 16,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 9\n          }\n        },\n        /*#__PURE__*/\n        React.createElement(Input, {\n          action: {\n            color: 'teal',\n            labelPosition: 'left',\n            icon: 'add',\n            content: 'New task',\n            onClick: this.onTodoCreate\n          },\n          fluid: true,\n          actionPosition: \"left\",\n          placeholder: \"To change the world...\",\n          onChange: this.handleNameChange,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 11\n          }\n        })),\n        /*#__PURE__*/\n        React.createElement(Grid.Column, {\n          width: 16,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 9\n          }\n        },\n        /*#__PURE__*/\n        React.createElement(Divider, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 11\n          }\n        })))\n      );\n    }\n  }, {\n    key: \"renderTodos\",\n    value: function renderTodos() {\n      if (this.state.loadingTodos) {\n        return this.renderLoading();\n      }\n\n      return this.renderTodosList();\n    }\n  }, {\n    key: \"renderLoading\",\n    value: function renderLoading() {\n      return (\n        /*#__PURE__*/\n        React.createElement(Grid.Row, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 7\n          }\n        },\n        /*#__PURE__*/\n        React.createElement(Loader, {\n          indeterminate: true,\n          active: true,\n          inline: \"centered\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 9\n          }\n        }, \"Loading TODOs\"))\n      );\n    }\n  }, {\n    key: \"renderTodosList\",\n    value: function renderTodosList() {\n      var _this2 = this;\n\n      return (\n        /*#__PURE__*/\n        React.createElement(Grid, {\n          padded: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 7\n          }\n        }, this.state.todos.map(function (todo, pos) {\n          return (\n            /*#__PURE__*/\n            React.createElement(Grid.Row, {\n              key: todo.todoId,\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 164,\n                columnNumber: 13\n              }\n            },\n            /*#__PURE__*/\n            React.createElement(Grid.Column, {\n              width: 1,\n              verticalAlign: \"middle\",\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 15\n              }\n            },\n            /*#__PURE__*/\n            React.createElement(Checkbox, {\n              onChange: function onChange() {\n                return _this2.onTodoCheck(pos);\n              },\n              checked: todo.done,\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 166,\n                columnNumber: 17\n              }\n            })),\n            /*#__PURE__*/\n            React.createElement(Grid.Column, {\n              width: 10,\n              verticalAlign: \"middle\",\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 171,\n                columnNumber: 15\n              }\n            }, todo.name),\n            /*#__PURE__*/\n            React.createElement(Grid.Column, {\n              width: 3,\n              floated: \"right\",\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 15\n              }\n            }, todo.dueDate),\n            /*#__PURE__*/\n            React.createElement(Grid.Column, {\n              width: 1,\n              floated: \"right\",\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 177,\n                columnNumber: 15\n              }\n            },\n            /*#__PURE__*/\n            React.createElement(Button, {\n              icon: true,\n              color: \"blue\",\n              onClick: function onClick() {\n                return _this2.onEditButtonClick(todo.todoId);\n              },\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 178,\n                columnNumber: 17\n              }\n            },\n            /*#__PURE__*/\n            React.createElement(Icon, {\n              name: \"pencil\",\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 183,\n                columnNumber: 19\n              }\n            }))),\n            /*#__PURE__*/\n            React.createElement(Grid.Column, {\n              width: 1,\n              floated: \"right\",\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 186,\n                columnNumber: 15\n              }\n            },\n            /*#__PURE__*/\n            React.createElement(Button, {\n              icon: true,\n              color: \"red\",\n              onClick: function onClick() {\n                return _this2.onTodoDelete(todo.todoId);\n              },\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 187,\n                columnNumber: 17\n              }\n            },\n            /*#__PURE__*/\n            React.createElement(Icon, {\n              name: \"delete\",\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 192,\n                columnNumber: 19\n              }\n            }))), todo.attachmentUrl &&\n            /*#__PURE__*/\n            React.createElement(Image, {\n              src: todo.attachmentUrl,\n              size: \"small\",\n              wrapped: true,\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 196,\n                columnNumber: 17\n              }\n            }),\n            /*#__PURE__*/\n            React.createElement(Grid.Column, {\n              width: 16,\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 15\n              }\n            },\n            /*#__PURE__*/\n            React.createElement(Divider, {\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 199,\n                columnNumber: 17\n              }\n            })))\n          );\n        }))\n      );\n    }\n  }, {\n    key: \"calculateDueDate\",\n    value: function calculateDueDate() {\n      var date = new Date();\n      date.setDate(date.getDate() + 7);\n      return dateFormat(date, 'yyyy-mm-dd');\n    }\n  }]);\n\n  return Todos;\n}(React.PureComponent);","map":{"version":3,"sources":["/home/ubuntu/Capstone/client/src/components/Todos.tsx"],"names":["dateFormat","update","React","Button","Checkbox","Divider","Grid","Header","Icon","Input","Image","Loader","createTodo","deleteTodo","getTodos","patchTodo","Todos","state","todos","newTodoName","loadingTodos","handleNameChange","event","setState","target","value","onEditButtonClick","todoId","props","history","push","onTodoCreate","dueDate","calculateDueDate","auth","getIdToken","name","newTodo","alert","onTodoDelete","filter","todo","onTodoCheck","pos","done","$set","message","renderCreateTodoInput","renderTodos","color","labelPosition","icon","content","onClick","renderLoading","renderTodosList","map","attachmentUrl","date","Date","setDate","getDate","PureComponent"],"mappings":"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","sourcesContent":["import dateFormat from 'dateformat'\nimport { History } from 'history'\nimport update from 'immutability-helper'\nimport * as React from 'react'\nimport {\n  Button,\n  Checkbox,\n  Divider,\n  Grid,\n  Header,\n  Icon,\n  Input,\n  Image,\n  Loader\n} from 'semantic-ui-react'\n\nimport { createTodo, deleteTodo, getTodos, patchTodo } from '../api/todos-api'\nimport Auth from '../auth/Auth'\nimport { Todo } from '../types/Todo'\n\ninterface TodosProps {\n  auth: Auth\n  history: History\n}\n\ninterface TodosState {\n  todos: Todo[]\n  newTodoName: string\n  loadingTodos: boolean\n}\n\nexport class Todos extends React.PureComponent<TodosProps, TodosState> {\n  state: TodosState = {\n    todos: [],\n    newTodoName: '',\n    loadingTodos: true\n  }\n\n  handleNameChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({ newTodoName: event.target.value })\n  }\n\n  onEditButtonClick = (todoId: string) => {\n    this.props.history.push(`/todos/${todoId}/edit`)\n  }\n\n  onTodoCreate = async (event: React.ChangeEvent<HTMLButtonElement>) => {\n    try {\n      const dueDate = this.calculateDueDate()\n      const newTodo = await createTodo(this.props.auth.getIdToken(), {\n        name: this.state.newTodoName,\n        dueDate\n      })\n      this.setState({\n        todos: [...this.state.todos, newTodo],\n        newTodoName: ''\n      })\n    } catch {\n      alert('Todo creation failed')\n    }\n  }\n\n  onTodoDelete = async (todoId: string) => {\n    try {\n      await deleteTodo(this.props.auth.getIdToken(), todoId)\n      this.setState({\n        todos: this.state.todos.filter(todo => todo.todoId != todoId)\n      })\n    } catch {\n      alert('Todo deletion failed')\n    }\n  }\n\n  onTodoCheck = async (pos: number) => {\n    try {\n      const todo = this.state.todos[pos]\n      await patchTodo(this.props.auth.getIdToken(), todo.todoId, {\n        name: todo.name,\n        dueDate: todo.dueDate,\n        done: !todo.done\n      })\n      this.setState({\n        todos: update(this.state.todos, {\n          [pos]: { done: { $set: !todo.done } }\n        })\n      })\n    } catch {\n      alert('Todo deletion failed')\n    }\n  }\n\n  async componentDidMount() {\n    try {\n      const todos = await getTodos(this.props.auth.getIdToken())\n      this.setState({\n        todos,\n        loadingTodos: false\n      })\n    } catch (e) {\n      alert(`Failed to fetch todos: ${e.message}`)\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <Header as=\"h1\">TODOs</Header>\n\n        {this.renderCreateTodoInput()}\n\n        {this.renderTodos()}\n      </div>\n    )\n  }\n\n  renderCreateTodoInput() {\n    return (\n      <Grid.Row>\n        <Grid.Column width={16}>\n          <Input\n            action={{\n              color: 'teal',\n              labelPosition: 'left',\n              icon: 'add',\n              content: 'New task',\n              onClick: this.onTodoCreate\n            }}\n            fluid\n            actionPosition=\"left\"\n            placeholder=\"To change the world...\"\n            onChange={this.handleNameChange}\n          />\n        </Grid.Column>\n        <Grid.Column width={16}>\n          <Divider />\n        </Grid.Column>\n      </Grid.Row>\n    )\n  }\n\n  renderTodos() {\n    if (this.state.loadingTodos) {\n      return this.renderLoading()\n    }\n\n    return this.renderTodosList()\n  }\n\n  renderLoading() {\n    return (\n      <Grid.Row>\n        <Loader indeterminate active inline=\"centered\">\n          Loading TODOs\n        </Loader>\n      </Grid.Row>\n    )\n  }\n\n  renderTodosList() {\n    return (\n      <Grid padded>\n        {this.state.todos.map((todo, pos) => {\n          return (\n            <Grid.Row key={todo.todoId}>\n              <Grid.Column width={1} verticalAlign=\"middle\">\n                <Checkbox\n                  onChange={() => this.onTodoCheck(pos)}\n                  checked={todo.done}\n                />\n              </Grid.Column>\n              <Grid.Column width={10} verticalAlign=\"middle\">\n                {todo.name}\n              </Grid.Column>\n              <Grid.Column width={3} floated=\"right\">\n                {todo.dueDate}\n              </Grid.Column>\n              <Grid.Column width={1} floated=\"right\">\n                <Button\n                  icon\n                  color=\"blue\"\n                  onClick={() => this.onEditButtonClick(todo.todoId)}\n                >\n                  <Icon name=\"pencil\" />\n                </Button>\n              </Grid.Column>\n              <Grid.Column width={1} floated=\"right\">\n                <Button\n                  icon\n                  color=\"red\"\n                  onClick={() => this.onTodoDelete(todo.todoId)}\n                >\n                  <Icon name=\"delete\" />\n                </Button>\n              </Grid.Column>\n              {todo.attachmentUrl && (\n                <Image src={todo.attachmentUrl} size=\"small\" wrapped />\n              )}\n              <Grid.Column width={16}>\n                <Divider />\n              </Grid.Column>\n            </Grid.Row>\n          )\n        })}\n      </Grid>\n    )\n  }\n\n  calculateDueDate(): string {\n    const date = new Date()\n    date.setDate(date.getDate() + 7)\n\n    return dateFormat(date, 'yyyy-mm-dd') as string\n  }\n}\n"]},"metadata":{},"sourceType":"module"}